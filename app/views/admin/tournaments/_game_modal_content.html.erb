<%= turbo_frame_tag "game_modal_#{game.id}" do %>
  <%= simple_form_for game, url: admin_tournament_game_path(tournament, game), method: :patch, local: true, html: { multipart: true } do |f| %>
    <div class="modal-body">
      <div class="row">
        <div class="col-md-6">
          <h6 class="text-primary">Informations du match</h6>
          <div class="mb-3">
            <strong><%= game.home_team.name %></strong> vs <strong><%= game.away_team.name %></strong>
          </div>

          <div class="mb-3">
            <label for="game_start_time" class="form-label">Heure du match</label>
            <input type="time"
                   name="game[game_start_time]"
                   id="game_start_time"
                   value="<%= game.game_start&.strftime("%H:%M") %>"
                   class="form-control" />
            <div class="form-text">Date du tournoi: <%= tournament.start_date.strftime("%d/%m/%Y") %></div>
          </div>

          <%= f.input :court_number,
                      label: "Numéro de terrain",
                      input_html: { class: "form-control", placeholder: "ex: Terrain 1" } %>
        </div>

        <div class="col-md-6">
          <h6 class="text-primary">Scores</h6>
          <div class="row">
            <div class="col-6">
              <%= f.input :home_score,
                          label: game.home_team.name,
                          as: :integer,
                          input_html: { class: "form-control", min: 0 } %>
            </div>
            <div class="col-6">
              <%= f.input :away_score,
                          label: game.away_team.name,
                          as: :integer,
                          input_html: { class: "form-control", min: 0 } %>
            </div>
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col-12">
          <h6 class="text-primary mb-3">
            <i class="fas fa-whistle me-2"></i>Arbitres
          </h6>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="referee_1_id" class="form-label">
                  <i class="fas fa-user-tie me-1"></i>Arbitre 1
                </label>
                <select name="game[referee_1_id]" id="referee_1_id" class="form-select">
                  <option value="">— Sélectionner un arbitre —</option>
                  <% referees.each do |referee| %>
                    <option value="<%= referee.id %>" <%= 'selected' if game.referees.include?(referee) && game.referees.first == referee %>>
                      <%= referee.name %>
                    </option>
                  <% end %>
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="referee_2_id" class="form-label">
                  <i class="fas fa-user-tie me-1"></i>Arbitre 2
                </label>
                <select name="game[referee_2_id]" id="referee_2_id" class="form-select">
                  <option value="">— Sélectionner un arbitre —</option>
                  <% referees.each do |referee| %>
                    <option value="<%= referee.id %>" <%= 'selected' if game.referees.include?(referee) && game.referees.second == referee %>>
                      <%= referee.name %>
                    </option>
                  <% end %>
                </select>
              </div>
            </div>
          </div>
          <div class="form-text">
            <i class="fas fa-info-circle me-1"></i>
            Sélectionnez jusqu'à 2 arbitres pour ce match
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
      <%= f.submit "Mettre à jour", class: "btn btn-primary" %>
    </div>
  <% end %>
<% end %>
